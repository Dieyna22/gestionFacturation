<app-navbar></app-navbar>
<app-sidebar></app-sidebar>
<div class="zoneSearch mb-2 mt-4">
  <div class="input-group">
    <input type="search" class="form-control" aria-label="Recipient's username" placeholder="type, num√©ro,nom,prenom">
    <button class="btn btnSearch" type="button" id="button-addon2"><i class="bi bi-search"></i></button>
  </div>
  <div class="d-flex filtre" id="fournisseur" *ngIf="currentDoc==='fournisseur'">
    <button type="button" class="btn btnOutline" [ngClass]="{'btnOutlineActive': actif === 1}"
      (click)="listeFournisseur(); actif = 1">Tout</button>
    <button type="button" class="btn btnOutline" [ngClass]="{'btnOutlineActive': actif === 2}"
      (click)="filterFournisseur('particulier'); actif = 2">Particulier</button>
    <button type="button" class="btn btnOutline" [ngClass]="{'btnOutlineActive': actif === 3}"
      (click)="filterFournisseur('entreprise'); actif = 3">Entreprise</button>
  </div>
  <div class="d-flex filtre" id="depense" *ngIf="currentDoc==='depense'">
    <button type="button" class="btn btnOutline" [ngClass]="{'btnOutlineActive': actif === 1}"
      (click)="listeDepense(); actif = 1">Tout</button>
    <button type="button" class="btn btnOutline" [ngClass]="{'btnOutlineActive': actif === 2}"
      (click)="filterDepense('impayer'); actif = 2">Impay√©es</button>
    <button type="button" class="btn btnOutline" [ngClass]="{'btnOutlineActive': actif === 3}"
      (click)="filterDepense('payer'); actif = 3">Pay√©es</button>
  </div>
</div>

<!-- Contenu dashbord  -->
<div class="mb-5">
  <div class="contenu">

    <div class="header d-grid gap-2 d-md-flex justify-content-md-end">
      <ul class="nav">
        <li><a [ngClass]="{'currentItemNav': boutonActif === 1}" (click)="showTypeDocument('fournisseur')"
            (click)="boutonActif = 1" (click)="listeFournisseur()">Fournisseurs</a></li>
        <li><a [ngClass]="{'currentItemNav': boutonActif === 2}" (click)="showTypeDocument('depense')"
            (click)="boutonActif = 2" (click)="listeDepense()">D√©penses</a></li>
      </ul>
    </div>
    <!-- Fournisseur -->
    <div class="col-md-12" id="fournisseur" *ngIf="currentDoc==='fournisseur'">
      <div class="card mb-4 px-2 py-2 pt-4 rounded-4">
        <div class=" me-5 mb-2 d-md-flex justify-content-md-end">
          <button type="button" class="btn ajouter mb-2" data-bs-toggle="modal" data-bs-target="#addfournisseur"
            (click)="vider();changeValueModal('ajoutFournisseur')">
            Ajouter Fournisseur
          </button>
        </div>
        <div class="row sectionEspace ligneReseauSearch mb-3">
          <div class="col-md-5">
            <h3 class="fw-bold">Listes Fournisseurs</h3>
          </div>
          <div class="col-md-7">
          </div>
        </div>

        <!-- Le tableau des fournisseurs -->
        <div class="table-responsive">
          <table class="table table-hover mb-4" id="fournisseur">
            <thead class="mb-2">
              <tr>
                <th scope="col">Num√©ro </th>
                <th scope="col">Type Fournisseur</th>
                <th scope="col">Nom</th>
                <th scope="col">Adresse </th>
                <th scope="col">Email </th>
                <th scope="col">T√©l√©phone </th>
                <th scope="col">Action </th>
              </tr>
            </thead>
            <tbody *ngFor="let fournisseur of getItemsPage()">
              <tr>
                <td (click)="chargerInfoFournisseur(fournisseur);changeValueModal('updateFournisseur')"
                  data-bs-toggle="modal" data-bs-target="#updateFournisseur">{{fournisseur.num_fournisseur}}</td>
                <td (click)="chargerInfoFournisseur(fournisseur);changeValueModal('updateFournisseur')"
                  data-bs-toggle="modal" data-bs-target="#updateFournisseur">{{fournisseur.type_fournisseur}}</td>
                <td (click)="chargerInfoFournisseur(fournisseur);changeValueModal('updateFournisseur')"
                  data-bs-toggle="modal" data-bs-target="#updateFournisseur">
                  <span *ngIf="fournisseur.type_fournisseur=='particulier'" title="particulier" class="me-2"> <i
                      class="bi bi-person"></i></span>
                  <span *ngIf="fournisseur.type_fournisseur=='entreprise'" title="entreprise" class="me-2"> <i
                      class="bi bi-buildings"></i></span>
                  {{fournisseur.prenom_fournisseur}} {{fournisseur.nom_fournisseur}} {{fournisseur.nom_entreprise}}
                  <span *ngIf="fournisseur.etiquettes && fournisseur.etiquettes.length > 0" class="etiquettes">
                    <span *ngFor="let etiq of fournisseur.etiquettes; let i = index"
                      [ngStyle]="{'background-color': etiq.code_etiquette}" class="etiquette me-2">
                      {{ etiq.nom_etiquette }}<span *ngIf="i < fournisseur.etiquettes.length - 1">, </span>
                    </span>
                  </span>
                </td>
                <td (click)="chargerInfoFournisseur(fournisseur);changeValueModal('updateFournisseur')"
                  data-bs-toggle="modal" data-bs-target="#updateFournisseur">{{fournisseur.adress_fournisseur}}</td>
                <td (click)="chargerInfoFournisseur(fournisseur);changeValueModal('updateFournisseur')"
                  data-bs-toggle="modal" data-bs-target="#updateFournisseur">{{fournisseur.email_fournisseur}}</td>
                <td (click)="chargerInfoFournisseur(fournisseur);changeValueModal('updateFournisseur')"
                  data-bs-toggle="modal" data-bs-target="#updateFournisseur">{{fournisseur.tel_fournisseur}}</td>
                <td>
                  <i class="bi bi-pencil-square me-2" title="modifier"
                    (click)="chargerInfoFournisseur(fournisseur);changeValueModal('updateFournisseur')"
                    data-bs-toggle="modal" data-bs-target="#updateFournisseur"></i>
                  <i class="bi bi-trash3" title="Supprimer" (click)="supprimerFournisseur(fournisseur.id)"></i>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div *ngIf="getItemsPage().length">
          <div class="d-flex justify-content-end mb-2">
            <button class="border border-0 btnColor  mx-2" [disabled]="pageActuelle === 1"
              (click)="pageActuelle = pageActuelle - 1">
              <i class="bi bi-arrow-left-circle fs-4"></i>
            </button>
            <button class=" rounded-circle mx-2 page" *ngFor="let page of pages" (click)="pageActuelle = page">
              <span class="pageActuelle fs-5" *ngIf="page===pageActuelle">{{page}}</span>
              <span *ngIf="page != pageActuelle">{{page}}</span>
            </button>
            <button class="border border-0 btnColor mx-2" [disabled]="pageActuelle === totalPages"
              (click)="pageActuelle = pageActuelle + 1">
              <i class="bi bi-arrow-right-circle fs-4"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- depense -->
    <div class="col-md-12" id="depense" *ngIf="currentDoc==='depense'">
      <div class="card mb-4 px-2 py-2 pt-4 rounded-4">
        <div class=" me-5 mb-2 d-md-flex justify-content-md-end">
          <button type="button" class="btn ajouter mb-2" data-bs-toggle="modal" data-bs-target="#adddepence"
            (click)="vider();changeValueModal('ajoutDepense')">
            Ajouter D√©pense
          </button>
        </div>

        <div class="row sectionEspace ligneReseauSearch mb-3">
          <div class="col-md-5">
            <h3 class="fw-bold">Listes D√©penses</h3>
          </div>
          <div class="col-md-7">
          </div>
        </div>

        <!-- Le tableau des depenses -->
        <div class="table-responsive">
          <table class="table table-hover mb-4" id="depense">
            <thead class="mb-2">
              <tr>
                <th scope="col">Num√©ro </th>
                <th scope="col">Date </th>
                <th scope="col">Cat√©gorie</th>
                <th scope="col">Fournisseur </th>
                <th scope="col">Total Ht </th>
                <th scope="col">Total Ttc </th>
                <th scope="col">Action </th>
              </tr>
            </thead>
            <tbody *ngFor="let depense of getItemsPage()">
              <tr>
                <td (click)="chargerInfoDepense(depense);changeValueModal('modifDepense')" data-bs-toggle="modal"
                  data-bs-target="#updateDepense">{{depense.num_depense}}</td>
                <td (click)="chargerInfoDepense(depense);changeValueModal('modifDepense')" data-bs-toggle="modal"
                  data-bs-target="#updateDepense">{{depense.date_paiement}}</td>
                <td (click)="chargerInfoDepense(depense);changeValueModal('modifDepense')" data-bs-toggle="modal"
                  data-bs-target="#updateDepense">
                  {{depense.nom_categorie_depense}}
                  <span *ngIf="depense.etiquettes && depense.etiquettes.length > 0" class="etiquettes">
                    <span *ngFor="let etiq of depense.etiquettes; let i = index"
                      [ngStyle]="{'background-color': etiq.code_etiquette}" class="etiquette me-2">
                      {{ etiq.nom_etiquette }}<span *ngIf="i < depense.etiquettes.length - 1">, </span>
                    </span>
                  </span>
                </td>
                <td (click)="chargerInfoDepense(depense);changeValueModal('modifDepense')" data-bs-toggle="modal"
                  data-bs-target="#updateDepense">{{depense.prenom_fournisseur}} {{depense.nom_fournisseur}}</td>
                <td (click)="chargerInfoDepense(depense);changeValueModal('modifDepense')" data-bs-toggle="modal"
                  data-bs-target="#updateDepense">{{depense.montant_depense_ht}}</td>
                <td (click)="chargerInfoDepense(depense);changeValueModal('modifDepense')" data-bs-toggle="modal"
                  data-bs-target="#updateDepense">{{depense.montant_depense_ttc}}</td>
                <td>
                  <i class="bi bi-pencil-square me-2" title="modifier"
                    (click)="chargerInfoDepense(depense);changeValueModal('modifDepense')" data-bs-toggle="modal"
                    data-bs-target="#updateDepense"></i>
                  <i class="bi bi-trash3" title="Supprimer" (click)="supprimerDepense(depense.id)"></i>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div *ngIf="getItemsPage().length">
          <div class="d-flex justify-content-end mb-2">
            <button class="border border-0 btnColor  mx-2" [disabled]="pageActuelle === 1"
              (click)="pageActuelle = pageActuelle - 1">
              <i class="bi bi-arrow-left-circle fs-4"></i>
            </button>
            <button class=" rounded-circle mx-2 page" *ngFor="let page of pages" (click)="pageActuelle = page">
              <span class="pageActuelle fs-5" *ngIf="page===pageActuelle">{{page}}</span>
              <span *ngIf="page != pageActuelle">{{page}}</span>
            </button>
            <button class="border border-0 btnColor mx-2" [disabled]="pageActuelle === totalPages"
              (click)="pageActuelle = pageActuelle + 1">
              <i class="bi bi-arrow-right-circle fs-4"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
     <!-- btn exporter docs -->
     <div (click)="exportExcel()" class="mt-5">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256"
        width="30px" height="30px">
        <g fill-opacity="0.32941" fill="#000000" fill-rule="nonzero" stroke="none" stroke-width="1"
          stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray=""
          stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none"
          style="mix-blend-mode: normal">
          <g transform="scale(5.12,5.12)">
            <path
              d="M28.875,0c-0.01953,0.00781 -0.04297,0.01953 -0.0625,0.03125l-28,5.3125c-0.47656,0.08984 -0.82031,0.51172 -0.8125,1v37.3125c-0.00781,0.48828 0.33594,0.91016 0.8125,1l28,5.3125c0.28906,0.05469 0.58984,-0.01953 0.82031,-0.20703c0.22656,-0.1875 0.36328,-0.46484 0.36719,-0.76172v-5h17c1.09375,0 2,-0.90625 2,-2v-34c0,-1.09375 -0.90625,-2 -2,-2h-17v-5c0.00391,-0.28906 -0.12109,-0.5625 -0.33594,-0.75391c-0.21484,-0.19141 -0.50391,-0.28125 -0.78906,-0.24609zM28,2.1875v4.34375c-0.13281,0.27734 -0.13281,0.59766 0,0.875v35.40625c-0.02734,0.13281 -0.02734,0.27344 0,0.40625v4.59375l-26,-4.96875v-35.6875zM30,8h17v34h-17v-5h4v-2h-4v-6h4v-2h-4v-5h4v-2h-4v-5h4v-2h-4zM36,13v2h8v-2zM6.6875,15.6875l5.46875,9.34375l-5.96875,9.34375h5l3.25,-6.03125c0.22656,-0.58203 0.375,-1.02734 0.4375,-1.3125h0.03125c0.12891,0.60938 0.25391,1.02344 0.375,1.25l3.25,6.09375h4.96875l-5.75,-9.4375l5.59375,-9.25h-4.6875l-2.96875,5.53125c-0.28516,0.72266 -0.48828,1.29297 -0.59375,1.65625h-0.03125c-0.16406,-0.60937 -0.35156,-1.15234 -0.5625,-1.59375l-2.6875,-5.59375zM36,20v2h8v-2zM36,27v2h8v-2zM36,35v2h8v-2z">
            </path>
          </g>
        </g>
      </svg>
    </div>
  </div>
</div>

<!-- Modal configuration num√©ro -->
<div class="modal fade mt-5" id="setting" tabindex="-1" aria-labelledby="settingLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="d-grid gap-2 p-2 d-md-flex justify-content-md-end">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="config">
          <h1>Configurer num√©rotation automatique de ventes</h1>

          <!-- <div class="option">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="" id="flexCheckIndeterminate" checked>
              <label class="form-check-label" for="flexCheckIndeterminate">
                Champ num√©ro modifiable
              </label>
            </div>
          </div> -->


          <div class="form-check ">
            <input class="form-check-input" type="radio" name="flexRadioDefault1" value="par_defaut"
              [(ngModel)]="numerotation" id="flexRadioDefault1" (click)="showNumConfig('sansPrefixes')" checked
              (change)="updatePrefix()">
            <label class="form-check-label" for="flexRadioDefault1">
              Num√©rotation par d√©faut (incr√©ment√©e de fa√ßon alphanum√©rique)
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="flexRadioDefault2" value="avec_prefixe"
              [(ngModel)]="numerotation" id="flexRadioDefault2" (click)="showNumConfig('avecPrefixes')">
            <label class="form-check-label" for="flexRadioDefault2">
              Num√©rotation avec pr√©fixe
            </label>
          </div>

          <div class="option" id="avecPrefixes" *ngIf="currentNumConfig==='avecPrefixes'">
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="custom" (change)="updatePrefix()">
                Pr√©fixe personnalis√© :
                <input type="text" [disabled]="selectedPrefix !== 'custom'" [(ngModel)]="customPrefix"
                  (ngModelChange)="updatePrefix()">
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee" (change)="updatePrefix()">
                Pr√©fixe avec l'ann√©e en cours
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee_mois"
                  (change)="updatePrefix()">
                Pr√©fixe avec l'ann√©e et le mois en cours
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee_mois_jour"
                  (change)="updatePrefix()">
                Pr√©fixe avec l'ann√©e, le mois et le jour en cours
              </label>
            </div>
            <div class="next-number">
              <label>Prochain num√©ro :</label>
              <input type="text" name="nextNumber" [(ngModel)]="nextNumber" readonly>
            </div>
          </div>

          <div id="sansPrefixes" *ngIf="currentNumConfig==='sansPrefixes'">
            <div class="next-number">
              <label>Prochain num√©ro :</label>
              <input type="text" [(ngModel)]="nextNumber" readonly>
            </div>
          </div>


          <button class="save-btn" data-bs-toggle="modal" data-bs-target="#addfournisseur"
            (click)="configurationNumero()">Sauvegarder</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal configuration num√©ro Depense -->
<div class="modal fade mt-5" id="settingDepense" tabindex="-1" aria-labelledby="settingLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="d-grid gap-2 p-2 d-md-flex justify-content-md-end">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="config">
          <h1>Configurer num√©rotation automatique de ventes</h1>

          <div class="option">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="" id="flexCheckIndeterminate" checked>
              <label class="form-check-label" for="flexCheckIndeterminate">
                Champ num√©ro modifiable
              </label>
            </div>
          </div>


          <div class="form-check ">
            <input class="form-check-input" type="radio" name="flexRadioDefault" value="par_defaut"
              [(ngModel)]="numerotation" id="flexRadioDefault1" (click)="showNumConfig('sansPrefixes')" checked>
            <label class="form-check-label" for="flexRadioDefault1">
              Num√©rotation par d√©faut (incr√©ment√©e de fa√ßon alphanum√©rique)
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="flexRadioDefault" value="avec_prefixe"
              [(ngModel)]="numerotation" id="flexRadioDefault2" (click)="showNumConfig('avecPrefixes')">
            <label class="form-check-label" for="flexRadioDefault2">
              Num√©rotation avec pr√©fixe
            </label>
          </div>

          <div class="option" id="avecPrefixes" *ngIf="currentNumConfig==='avecPrefixes'">
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="custom" (change)="updatePrefix()">
                Pr√©fixe personnalis√© :
                <input type="text" [disabled]="selectedPrefix !== 'custom'" [(ngModel)]="customPrefix"
                  (ngModelChange)="updatePrefix()">
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee" (change)="updatePrefix()">
                Pr√©fixe avec l'ann√©e en cours
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee_mois"
                  (change)="updatePrefix()">
                Pr√©fixe avec l'ann√©e et le mois en cours
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee_mois_jour"
                  (change)="updatePrefix()">
                Pr√©fixe avec l'ann√©e, le mois et le jour en cours
              </label>
            </div>
            <div class="next-number">
              <label>Prochain num√©ro :</label>
              <input type="text" name="nextNumberDepense" [(ngModel)]="nextNumberDepense" readonly>
            </div>
          </div>

          <div id="sansPrefixes" *ngIf="currentNumConfig==='sansPrefixes'">
            <div class="next-number">
              <label>Prochain num√©ro :</label>
              <input type="text" [(ngModel)]="nextNumberDepense" readonly>
            </div>
          </div>


          <button class="save-btn" data-bs-toggle="modal" data-bs-target="#adddepence"
            (click)="configurationNumeroDepense()">Sauvegarder</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal ajouter fournisseur -->
<div class="modal fade mt-5" id="addfournisseur" tabindex="-1" aria-labelledby="addfournisseurLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered ">
    <div class="modal-content">
      <div class="bgHeader">
        <div class="d-flex justify-content-between p-2">
          <h4 class="modal-title" id="exampleModalLabel">Ajout Fournisseur</h4>
          <div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
        </div>
      </div>
      <div class="modal-body">
        <div class="containerFournisseur">
          <div class="d-flex mb-2">
            <div class="p-3 flex-grow-1">
              <!-- <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                <label class="form-check-label" for="flexSwitchCheckDefault">Actif</label>
              </div> -->
            </div>
            <ng-container *ngIf="selectedEtiquettes.length > 0; else associerEtiquetteBlock" class="etiquettes">
              <span *ngFor="let etiq of selectedEtiquettes; let i = index"
                [ngStyle]="{'background-color': etiq.code_etiquette}" class="etiquette me-2 text-danger">
                {{ etiq.nom_etiquette }}
                <i class="bi bi-x-lg text-light" (click)="supprimerEtiquettechosi(i)"></i>
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-container>

            <ng-template #associerEtiquetteBlock>
              <span class="me-2" data-bs-toggle="modal" data-bs-target="#etiquette" style="cursor: pointer;">
                Associer √©tiquette
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-template>
          </div>
          <div class="header">
            <label for="numero">Num√©ro :&nbsp;</label>
            <input class="w-50" type="text" id="numero" name="nextNumber" [(ngModel)]="nextNumber" readonly>&nbsp;
            <i class="bi bi-gear" data-bs-toggle="modal" data-bs-target="#setting"></i>
          </div> <br><br>
          <div class="tabs">
            <div class="tab one" [ngClass]="{'active': zoneActif === 1}"
              (click)="showComponant('zoneParticulier'); setTypeFournisseur('particulier'); zoneActif = 1">
              <!-- üë§ -->
              <i class="bi bi-person"></i>
            </div>
            <div class="tab two" [ngClass]="{'active': zoneActif === 2}"
              (click)="showComponant('zoneEntreprise'); setTypeFournisseur('entreprise'); zoneActif = 2">
              <!-- üè¢ -->
              <i class="bi bi-buildings"></i>
            </div>
          </div>
          <form id="particulier" *ngIf="currentContent==='zoneParticulier'">
            <input type="text" class="form-control" placeholder="Pr√©nom" name="prenom" [(ngModel)]="prenom">
            <input type="text" class="form-control" placeholder="Nom" name="nom" [(ngModel)]="nom">
            <input type="text" class="form-control" placeholder="Adresse √©lectronique" name="email"
              [(ngModel)]="email"><br><br>
          </form>
          <form id="entreprise" *ngIf="currentContent==='zoneEntreprise'">
            <input type="text" class="form-control" placeholder="Nom de l'entreprise" name="nomEntreprise"
              [(ngModel)]="nomEntreprise">
            <input type="text" class="form-control" placeholder="N¬∞ Identification fiscale" name="codeFiscal"
              [(ngModel)]="codeFiscal">
            <input type="text" class="form-control" placeholder="Adresse √©lectronique" name="email"
              [(ngModel)]="email"><br><br>
          </form>
          <form>
            <input type="text" class="form-control" placeholder="Adresse" name="adresse" [(ngModel)]="adresse">
            <div class="row p-2">
              <input type="text" class="form-control" placeholder="Code Postal" name="codepostal"
                [(ngModel)]="codepostal">
              <input type="text" class="form-control" placeholder="Ville" name="ville" [(ngModel)]="ville">
            </div>
            <input type="text" class="form-control" placeholder="Pays" name="pays" [(ngModel)]="pays">
            <input type="text" class="form-control" placeholder="T√©l√©phone " name="tel" [(ngModel)]="tel"><br><br>

            <input type="text" class="form-control" placeholder="N¬∞ Compte" name="compte" [(ngModel)]="compte">
            <div class="row p-2">
              <input type="text" class="form-control" placeholder="Code Banque" name="banque" [(ngModel)]="banque">
              <input type="text" class="form-control" placeholder="Code Guichet" name="guichet" [(ngModel)]="guichet">
            </div>
            <input type="text" class="form-control" placeholder="Cl√© RIB" name="rib" [(ngModel)]="rib">
            <input type="text" class="form-control" placeholder="IBAN" name="iban" [(ngModel)]="iban"><br><br>
            <textarea placeholder="Commentaire :" name="note"></textarea>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btnAction" (click)="addFournisseur()">Ajouter</button>
        <button type="button" class="btn btnClose" data-bs-dismiss="modal">Annuler</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal modifier fournisseur -->
<div class="modal fade mt-5" id="updateFournisseur" tabindex="-1" aria-labelledby="updateFournisseurLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered ">
    <div class="modal-content">
      <div class="bgHeader">
        <div class="d-flex justify-content-between p-2">
          <h4 class="modal-title" id="exampleModalLabel">Modifier Fournisseur</h4>
          <div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
        </div>
      </div>
      <div class="modal-body">
        <div class="containerFournisseur">
          <div class="d-flex mb-2">
            <div class="p-3 flex-grow-1">
              <!-- <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                <label class="form-check-label" for="flexSwitchCheckDefault">Actif</label>
              </div> -->
            </div>
            <ng-container *ngIf="selectedEtiquettes.length > 0; else associerEtiquetteBlock" class="etiquettes">
              <span *ngFor="let etiq of selectedEtiquettes; let i = index"
                [ngStyle]="{'background-color': etiq.code_etiquette}" class="etiquette me-2 text-danger">
                {{ etiq.nom_etiquette }}
                <i class="bi bi-x-lg text-light" (click)="supprimerEtiquettechosi(i)"></i>
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-container>

            <ng-template #associerEtiquetteBlock>
              <span class="me-2" data-bs-toggle="modal" data-bs-target="#etiquette" style="cursor: pointer;">
                Associer √©tiquette
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-template>
          </div>
          <div class="header">
            <span>{{numFournisseur}}</span>
          </div> <br><br>
          <div class="tabs">
            <div class="tab one" [ngClass]="{'active': zoneActif === 1}"
              (click)="showComponant('particulier'); setTypeFournisseur('particulier'); zoneActif = 1">
              <!-- üë§ -->
              <i class="bi bi-person"></i>
            </div>
            <div class="tab two" [ngClass]="{'active': zoneActif === 2}"
              (click)="showComponant('entreprise'); setTypeFournisseur('entreprise'); zoneActif = 2">
              <!-- üè¢ -->
              <i class="bi bi-buildings"></i>
            </div>
          </div>
          <form id="particulier" *ngIf="currentContent==='particulier'">
            <input type="text" class="form-control" placeholder="Pr√©nom" name="prenom" [(ngModel)]="prenom">
            <input type="text" class="form-control" placeholder="Nom" name="nom" [(ngModel)]="nom">
            <input type="text" class="form-control" placeholder="Adresse √©lectronique" name="email"
              [(ngModel)]="email"><br><br>
          </form>
          <form id="entreprise" *ngIf="currentContent==='entreprise'">
            <input type="text" class="form-control" placeholder="Nom de l'entreprise" name="nomEntreprise"
              [(ngModel)]="nomEntreprise">
            <input type="text" class="form-control" placeholder="N¬∞ Identification fiscale" name="codeFiscal"
              [(ngModel)]="codeFiscal">
            <input type="text" class="form-control" placeholder="Adresse √©lectronique" name="email"
              [(ngModel)]="email"><br><br>
          </form>
          <form>
            <input type="text" class="form-control" placeholder="Adresse" name="adresse" [(ngModel)]="adresse">
            <div class="row p-2">
              <input type="text" class="form-control" placeholder="Code Postal" name="codepostal"
                [(ngModel)]="codepostal">
              <input type="text" class="form-control" placeholder="Ville" name="ville" [(ngModel)]="ville">
            </div>
            <input type="text" class="form-control" placeholder="Pays" name="pays" [(ngModel)]="pays">
            <input type="text" class="form-control" placeholder="T√©l√©phone " name="tel" [(ngModel)]="tel"><br><br>

            <input type="text" class="form-control" placeholder="N¬∞ Compte" name="compte" [(ngModel)]="compte">
            <div class="row p-2">
              <input type="text" class="form-control" placeholder="Code Banque" name="banque" [(ngModel)]="banque">
              <input type="text" class="form-control" placeholder="Code Guichet" name="guichet" [(ngModel)]="guichet">
            </div>
            <input type="text" class="form-control" placeholder="Cl√© RIB" name="rib" [(ngModel)]="rib">
            <input type="text" class="form-control" placeholder="IBAN" name="iban" [(ngModel)]="iban"><br><br>
            <textarea placeholder="Commentaire :" name="note"></textarea>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btnAction" (click)="updateFournisseur()">Modifier</button>
        <button type="button" class="btn btnClose" data-bs-dismiss="modal">Annuler</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal ajout cat√©gorie -->
<div class="modal fade mt-5" id="categorie" tabindex="-1" aria-labelledby="categorieLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="d-grid gap-2 p-2 d-md-flex justify-content-md-end">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h3>+ Ajouter cat√©gorie d√©pense</h3>
        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="text" name="categorie" [(ngModel)]="categorie">
          <label for="text">Nom Cat√©gorie</label>
        </div>
        <button class="btnAction mx-auto btn mt-3" (click)="addCategorieDepense()" data-bs-toggle="modal"
          data-bs-target="#adddepence">Sauvegarder</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Associer forunisseur -->
<div class="modal fade mt-5" id="fournisseur" tabindex="-1" aria-labelledby="fournisseurLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="d-grid gap-2 p-2 d-md-flex justify-content-md-end">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
          (click)="ouvrirModal()"></button>
      </div>
      <div class="modal-body">
        <h3>+ Associer un client</h3>
        <div class="input-group mb-2">
          <select class="form-select form-select-lg mb-3" aria-label="Large select example" name="idFournisseur"
            [(ngModel)]="idFournisseur" (change)="onClientSelected() ">
            <option selected>Selectionnez un fournisseur</option>
            <option *ngFor="let fournisseur of tabFournisseur" [value]="fournisseur.id">
              {{fournisseur.prenom_fournisseur}} {{fournisseur.nom_fournisseur}} {{fournisseur.nom_entreprise}}
            </option>
          </select>
        </div>
        <button class="btnAction mx-auto btn" data-bs-dismiss="modal" aria-label="Close"
          (click)="ouvrirModal()">Sauvegarder</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal ajouter depense -->
<div class="modal fade mt-5" id="adddepence" tabindex="-1" aria-labelledby="adddepenceLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg ">
    <div class="modal-content">
      <div class="bgHeader">
        <div class="d-flex justify-content-between p-2">
          <h4 class="modal-title" id="exampleModalLabel">Ajout Depense</h4>
          <div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
        </div>
      </div>
      <div class="modal-body">
        <div class="form-container">
          <div class="d-flex mb-2">
            <div class="p-3 flex-grow-1">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" name="active"
                  (click)="setTypeActive(true)">
                <label class="form-check-label" for="flexSwitchCheckDefault">Active</label>
              </div>
            </div>
            <ng-container *ngIf="selectedEtiquettes.length > 0; else associerEtiquetteBlock" class="etiquettes">
              <span *ngFor="let etiq of selectedEtiquettes; let i = index"
                [ngStyle]="{'background-color': etiq.code_etiquette}" class="etiquette me-2 text-danger">
                {{ etiq.nom_etiquette }}
                <i class="bi bi-x-lg text-light" (click)="supprimerEtiquettechosi(i)"></i>
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-container>

            <ng-template #associerEtiquetteBlock>
              <span class="me-2" data-bs-toggle="modal" data-bs-target="#etiquette" style="cursor: pointer;">
                Associer √©tiquette
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-template>
          </div>
          <div class="header">
            <label for="numero">Num√©ro :&nbsp;</label>
            <input class="w-50" type="text" id="numero" name="nextNumberDepense" [(ngModel)]="nextNumberDepense"
              readonly>&nbsp;
            <i class="bi bi-gear" data-bs-toggle="modal" data-bs-target="#settingDepense"></i>
          </div>
          <div class="client-section mb-3">
            <button class="associate-client" data-bs-toggle="modal" data-bs-target="#fournisseur"
              *ngIf="!currentFournisseur">+ Associer
              Fournisseur</button>
          </div>
          <div class="client-info mb-3" *ngFor="let fournisseurSelected of currentFournisseurSelected">
            <Span>Fournisseur</Span><br>
            <input type="text"
              value=" {{fournisseurSelected.prenom_fournisseur}} {{fournisseurSelected.nom_fournisseur}} {{fournisseurSelected.nom_entreprise}}"
              readonly>
            <div class="client-details">
              <span> {{fournisseurSelected.email_fournisseur}}</span>
            </div>
          </div>
          <div class="form-group">
            <label for="category">Cat√©gorie :</label>
            <select id="category" name="categorie" [(ngModel)]="categorie">
              <option data-bs-toggle="modal" data-bs-target="#categorie">+ Ajouter une cat√©gorie...</option>
              <option value="" disabled selected>S√©lectionnez une cat√©gorie...</option>
              <option *ngFor="let categorie of tabCategorie" [value]="categorie.id">{{categorie.nom_categorie_depense}}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="comment">Commentaire (facultatif) :</label>
            <textarea id="comment" name="note" [(ngModel)]="note"></textarea>
          </div>

          <div class="form-check" (click)="showInfosPayement()">
            <input class="form-check-input" type="checkbox" value="" id="defaultCheck1" name="depensePay"
              (click)="setTypedepensePay(true)">
            <label class="form-check-label" for="defaultCheck1">
              D√©pense avec plusieurs paiements
            </label>
          </div>

          <div class="√âch√©ance mx-auto p-2" *ngIf="infosPayement">
            <div class="form-check" (click)="showEcheancePay()">
              <input class="form-check-input" type="checkbox" value="" id="defaultCheck1" name="Duree"
                (click)="setTypeDuree(true)">
              <label class="form-check-label" for="defaultCheck1">
                Dur√©e ind√©termin√©e (nombre de paiements inconnu)
              </label>
            </div>
            <div class="row mb-2 mt-2 text-center" *ngIf="!echeancePay">
              <ng-container class="mb-2 mt-2" *ngFor="let item of input; let i = index">
                <div class="col-3"><label for="echeance1" class="me-1">√âch√©ance {{i+1}}: </label></div>
                <div class="col-3"><input type="date" id="echeance1" class="me-2" value="" [(ngModel)]="item.date">
                </div>
                <div class="col-4"><input type="number" id="montant1" class="me-2" value="" [(ngModel)]="item.prix">
                </div>
                <div class="col-2"><i class="bi bi-x-lg" style="color: red; cursor: pointer;"
                    (click)="deleteInput(i)"></i></div>
              </ng-container>
              <span (click)="addInput()" style="cursor: pointer;"><i class="bi bi-plus-circle me-2"></i>ajouter</span>
            </div>
            <div class="popup-vente mb-5" *ngIf="echeancePay">
              <span class="txt-title">Ces √©ch√©ances doivent √™tre programm√©es :</span>
              <div class="checkbox1">
                <div class="vente">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="defaultCheck1" checked>
                    <label class="form-check-label" for="defaultCheck1">
                      Une √©ch√©ance tous les :
                    </label>
                  </div>
                </div>
                <div class="duree text-center">
                  <input class="check1 me-2" type="number" name="periode" [(ngModel)]="periode">
                  <select name="" id="" name="durePeriode" class="check2" [(ngModel)]="durePeriode">
                    <option value="jour">Jour</option>
                    <option value="semaine">Semaine</option>
                    <option value="mois">Mois</option>
                  </select>
                </div>
              </div>
              <div class="date">
                <span>A partir du:</span>
                <input type="date" name="datePay" [(ngModel)]="datePay">
              </div>
              <div class="date">
                <span>Montant:&nbsp;</span>
                <input type="text" name="montantEcheance" [(ngModel)]="montantPay">
              </div>
            </div>
          </div>

          <div class="payment-info mx-auto p-2 mt-3 mb-2" *ngIf="!infosPayement">
            <h3>Information du paiement</h3>
            <div class="mb-3 row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Date :</label>
              <div class="col-sm-10">
                <input type="date" class="form-control" id="staticEmail" name="datePay" [(ngModel)]="datePay">
              </div>
            </div>
            <div class="form-check" (click)="showInputTva()">
              <input class="form-check-input" type="checkbox" value="" id="defaultCheck1">
              <label class="form-check-label" for="defaultCheck1">
                Tva
              </label>
            </div>

            <div class="mb-3 row" *ngIf="!showTva">
              <label for="staticEmail" class="col-sm-2 col-form-label">Montant :</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="staticEmail" name="montantPay" [(ngModel)]="montantPay">
              </div>
            </div>

            <ng-container *ngIf="showTva">
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">TVA :</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control" id="staticEmail" name="tva" [(ngModel)]="tva"
                    (ngModelChange)="calculerMontantTtc()">
                </div>
              </div>
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">Montant Ht :</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control" id="staticEmail" name="montantpay" [(ngModel)]="montantPay"
                    (ngModelChange)="calculerMontantTtc()">
                </div>
              </div>
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">Montant Ttc :</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control" id="staticEmail" name="montantPayTtc"
                    [(ngModel)]="montantPayTtc" readonly>
                </div>
              </div>
            </ng-container>

            <div class="form-check form-switch" *ngIf="statutPay=='impayer'">
              <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" name="payer"
                (click)="setTypeImpay('payer')">
              <label class="form-check-label" for="flexSwitchCheckDefault">Impay√©</label>
            </div>
            <div class="form-check form-switch" *ngIf="statutPay=='payer'">
              <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" checked
                name="impayer" (click)="setTypeImpay('impayer')">
              <label class="form-check-label" for="flexSwitchCheckDefault">pay√©</label>
            </div>

            <div class="row g-3 align-items-center" *ngIf="statutPay=='payer'">
              <div class="col-auto">
                <label for="inputPassword6" class="col-form-label">Moyen de paiement</label>
                <select class="form-select form-select-lg" id="client-select" placeholder="Type de paiement..."
                  [(ngModel)]="moyenPayement">
                  <option *ngFor="let paye of tabPayement" [value]="paye.id">{{paye.nom_payement}}</option>
                </select>
              </div>
            </div>

          </div>

          <a (click)='showInfosFacture()'>+ Saisir information de facturation</a>

          <div class="payment-info mx-auto p-2 mt-3" *ngIf="infosFacture">
            <h3>Information de facturation</h3>
            <div class="mb-3 row">
              <label for="numero" class="col-sm-2 col-form-label">Num√©ro :</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="numero" name="numero" [(ngModel)]="numero">
              </div>
            </div>
            <div class="mb-3 row">
              <label for="dateFacture" class="col-sm-2 col-form-label">Date :</label>
              <div class="col-sm-10">
                <input type="date" class="form-control" id="dateFacture" name="dateFacture" [(ngModel)]="dateFacture">
              </div>
            </div>
            <div class="mb-3 row">
              <label for="imageFacture" class="col-sm-2 col-form-label">Image Facture :</label>
              <div class="col-sm-10">
                <input type="file" class="form-control" id="imageFacture" name="imageFacture"
                  (change)="getFile($event)">
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btnAction" (click)="createDepense()">Ajouter</button>
          <button type="button" class="btn btnClose" data-bs-dismiss="modal">Annuler</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal modifier depense -->
<div class="modal fade mt-5" id="updateDepense" tabindex="-1" aria-labelledby="updateDepenseLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg ">
    <div class="modal-content" *ngIf="currentDepense">
      <div class="bgHeader">
        <div class="d-flex justify-content-between p-2">
          <h4 class="modal-title" id="exampleModalLabel">Modifier Depense</h4>
          <div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
        </div>
      </div>
      <div class="modal-body">
        <div class="form-container">
          <div class="d-flex mb-2">
            <div class="p-3 flex-grow-1">
              <!-- <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                <label class="form-check-label" for="flexSwitchCheckDefault">Actif</label>
              </div> -->
            </div>
            <ng-container *ngIf="selectedEtiquettes.length > 0; else associerEtiquetteBlock" class="etiquettes">
              <span *ngFor="let etiq of selectedEtiquettes; let i = index"
                [ngStyle]="{'background-color': etiq.code_etiquette}" class="etiquette me-2 text-danger">
                {{ etiq.nom_etiquette }}
                <i class="bi bi-x-lg text-light" (click)="supprimerEtiquettechosi(i)"></i>
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-container>

            <ng-template #associerEtiquetteBlock>
              <span class="me-2" data-bs-toggle="modal" data-bs-target="#etiquette" style="cursor: pointer;">
                Associer √©tiquette
              </span>
              <i class="bi bi-plus-circle-dotted" data-bs-toggle="modal" data-bs-target="#etiquette"></i>
            </ng-template>
          </div>
          <div class="row">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" name="active"
                (click)="setTypeActive(true)">
              <label class="form-check-label" for="flexSwitchCheckDefault">Active</label>
            </div>

            <div class="header col-8">
              <span>{{numDepense}}</span>
            </div>
          </div>

          <div class="client-section mb-3">
            <button class="associate-client" data-bs-toggle="modal" data-bs-target="#fournisseur"
              *ngIf="!currentFournisseur">+ Associer/changer
              Fournisseur</button>
          </div>
          <div class="client-info mb-3" *ngFor="let fournisseurSelected of currentFournisseurSelected ">
            <Span>Nouveau Fournisseur</Span><br>
            <input type="text"
              value=" {{fournisseurSelected.prenom_fournisseur}} {{fournisseurSelected.nom_fournisseur}} {{fournisseurSelected.nom_entreprise}}"
              readonly>
            <div class="client-details">
              <span> {{fournisseurSelected.email_fournisseur}}</span>
            </div>
          </div>

          <div class="form-group">
            <label for="category">Cat√©gorie :</label>
            <select id="category" name="categorie" [(ngModel)]="categorie">
              <option data-bs-toggle="modal" data-bs-target="#categorie">+ Ajouter une cat√©gorie...</option>
              <option value="" disabled selected>S√©lectionnez une cat√©gorie...</option>
              <option *ngFor="let categorie of tabCategorie" [value]="categorie.id">{{categorie.nom_categorie_depense}}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="comment">Commentaire (facultatif) :</label>
            <textarea id="comment" name="note" [(ngModel)]="note"></textarea>
          </div>


          <div class="payment-info text-center p-3"
            *ngIf="currentDepense.nombre_periode !==null && currentDepense.periode_echeance !==null ">
            <p>Une d√©pense de ce type est cr√©√©e automatiquement tous les {{currentDepense.nombre_periode }}
              {{currentDepense.periode_echeance }} √† partir du {{currentDepense.date_paiement }} pour un montant de
              {{currentDepense.montant_depense_ht}}.</p>
            <p>Date de la prochaine d√©pense : {{ calculerProchaineDateDepense(currentDepense.date_paiement,
              currentDepense.periode_echeance) }}</p>
            <button class="btn btnArret">Arr√™ter la cr√©ation automatique de d√©penses de ce type</button>
          </div>

          <div class="payment-info mx-auto p-2 mt-3 mb-2">
            <h3>Information du paiement</h3>
            <div class="mb-3 row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Date :</label>
              <div class="col-sm-10">
                <input type="date" class="form-control" id="staticEmail" name="datePay" [(ngModel)]="datePay">
              </div>
            </div>

            <ng-container *ngIf="currentDepense.tva_depense == null">
              <div class="form-check" (click)="showInputTva()">
                <input class="form-check-input" type="checkbox" value="" id="defaultCheck1">
                <label class="form-check-label" for="defaultCheck1">
                  Tva
                </label>
              </div>

              <div class="mb-3 row" *ngIf="!showTva">
                <label for="staticEmail" class="col-sm-2 col-form-label">Montant :</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="staticEmail" name="montantPay" [(ngModel)]="montantPay">
                </div>
              </div>

              <ng-container *ngIf="showTva">
                <div class="mb-3 row">
                  <label for="staticEmail" class="col-sm-2 col-form-label">TVA :</label>
                  <div class="col-sm-10">
                    <input type="number" class="form-control" id="staticEmail" name="tva" [(ngModel)]="tva"
                      (ngModelChange)="calculerMontantTtc()">
                  </div>
                </div>
                <div class="mb-3 row">
                  <label for="staticEmail" class="col-sm-2 col-form-label">Montant Ht :</label>
                  <div class="col-sm-10">
                    <input type="number" class="form-control" id="staticEmail" name="montantpay"
                      [(ngModel)]="montantPay" (ngModelChange)="calculerMontantTtc()">
                  </div>
                </div>
                <div class="mb-3 row">
                  <label for="staticEmail" class="col-sm-2 col-form-label">Montant Ttc :</label>
                  <div class="col-sm-10">
                    <input type="number" class="form-control" id="staticEmail" name="montantPayTtc"
                      [(ngModel)]="montantPayTtc" readonly>
                  </div>
                </div>
              </ng-container>
            </ng-container>

            <ng-container *ngIf="currentDepense.tva_depense !== null">
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">TVA :</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control" id="staticEmail" name="tva" [(ngModel)]="tva"
                    (ngModelChange)="calculerMontantTtc()">
                </div>
              </div>
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">Montant Ht :</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control" id="staticEmail" name="montantpay" [(ngModel)]="montantPay"
                    (ngModelChange)="calculerMontantTtc()">
                </div>
              </div>
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">Montant Ttc :</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control" id="staticEmail" name="montantPayTtc"
                    [(ngModel)]="montantPayTtc" readonly>
                </div>
              </div>
            </ng-container>

            <div class="form-check form-switch" *ngIf="statutPay=='impayer'">
              <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" name="payer"
                (click)="setTypeImpay('payer')">
              <label class="form-check-label" for="flexSwitchCheckDefault">Impay√©</label>
            </div>
            <div class="form-check form-switch" *ngIf="statutPay=='payer'">
              <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" checked
                name="impayer" (click)="setTypeImpay('impayer')">
              <label class="form-check-label" for="flexSwitchCheckDefault">pay√©</label>
            </div>

            <div class="row g-3 align-items-center" *ngIf="statutPay=='payer'">
              <div class="col-auto">
                <label for="inputPassword6" class="col-form-label">Moyen de paiement</label>
                <select class="form-select form-select-lg" id="client-select" placeholder="Type de paiement..."
                  [(ngModel)]="moyenPayement">
                  <option *ngFor="let paye of tabPayement" [value]="paye.id">{{paye.nom_payement}}</option>
                </select>
              </div>
            </div>

          </div>

          <ng-container *ngIf="currentDepense.num_facture == null && currentDepense.date_facture == null">
            <a (click)='showInfosFacture()'>+ Saisir information de facturation</a>

            <div class="payment-info mx-auto p-2 mt-3" *ngIf="infosFacture">
              <h3>Information de facturation</h3>
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">Num√©ro :</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="staticEmail" name="numero" [(ngModel)]="numero">
                </div>
              </div>
              <div class="mb-3 row">
                <label for="staticEmail" class="col-sm-2 col-form-label">Date :</label>
                <div class="col-sm-10">
                  <input type="date" class="form-control" id="staticEmail" name="dateFacture" [(ngModel)]="dateFacture">
                </div>
              </div>
            </div>
          </ng-container>


          <div class="payment-info mx-auto p-2 mt-3"
            *ngIf="currentDepense.num_facture !== null && currentDepense.date_facture !== null">
            <h3>Information de facturation</h3>
            <div class="mb-3 row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Num√©ro :</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="staticEmail" name="numero" [(ngModel)]="numero">
              </div>
            </div>
            <div class="mb-3 row">
              <label for="staticEmail" class="col-sm-2 col-form-label">Date :</label>
              <div class="col-sm-10">
                <input type="date" class="form-control" id="staticEmail" name="dateFacture" [(ngModel)]="dateFacture">
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btnAction" (click)="updateDepense()">Modifier</button>
          <button type="button" class="btn btnClose" data-bs-dismiss="modal">Annuler</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal associer √©tiquette  -->
<div class="modal fade mt-5" id="etiquette" tabindex="-1" aria-labelledby="etiquetteLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="d-flex">
        <div class="p-3 flex-grow-1">
          <h3 class="modal-title" id="etiquetteLabel">Associer √©tiquette</h3>
        </div>
        <div class="p-3"> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
            (click)="ouvrirModal()"></button>
        </div>
      </div>
      <div class="modal-body">
        <div class="etiquette-management">
          <!-- Liste des √©tiquettes et bouton Nouvelle √©tiquette -->
          <div *ngIf="tabEtiquette.length > 0 && !modeEdition && !addNewEtiquette">
            <div class="etiquettes ms-5">
              <div *ngFor="let etiq of tabEtiquette" [ngStyle]="{'background-color': etiq.code_etiquette}"
                class="etiquetteListe d-flex justify-content-between align-items-center mt-2"
                (click)="choisirEtiquette(etiq)">
                {{ etiq.nom_etiquette }}
                <div>
                  <!-- (click)="ouvrirModalArticle()" -->
                  <i class="bi bi-pencil me-2" (click)="editerEtiquette(etiq)"></i>
                  <i class="bi bi-trash2 me-2" (click)="supprimerEtiquette(etiq.id)"></i>
                </div>
              </div>
            </div>
            <a class="mt-3" (click)="newEtiquette()">+ Nouvelle √©tiquette</a>
          </div>

          <!-- Formulaire d'ajout -->
          <div *ngIf="(tabEtiquette.length === 0 && !modeEdition) || addNewEtiquette">
            <div class="couleurs">
              <div *ngFor="let couleur of couleurs" [ngStyle]="{'background-color': couleur}"
                (click)="selectionnerCouleur(couleur)" [class.selected]="couleur === etiquette.code_etiquette"
                class="couleur">
                <span *ngIf="couleur === etiquette.code_etiquette" class="checkmark">‚úî</span>
              </div>
            </div>

            <div class="mb-3">
              <label for="nom">Nom de l'√©tiquette :</label>
              <input class="form-control" type="text" placeholder="Nom √©tiquette" id="nom" name="nom"
                [(ngModel)]="etiquette.nom_etiquette">
            </div>

            <button class="btn btnAction me-2" (click)="ajouterEtiquette();ouvrirModal()">
              Sauvegarder
            </button>
            <button *ngIf="addNewEtiquette" class="btn btn-secondary"
              (click)="annulerAjout();ouvrirModal()">Annuler</button>
          </div>

          <!-- Formulaire de modification -->
          <div *ngIf="modeEdition">
            <div class="couleurs">
              <div *ngFor="let couleur of couleurs" [ngStyle]="{'background-color': couleur}"
                (click)="selectionnerCouleur(couleur)" [class.selected]="couleur === etiquette.code_etiquette"
                class="couleur">
                <span *ngIf="couleur === etiquette.code_etiquette" class="checkmark">‚úî</span>
              </div>
            </div>

            <div class="mb-3">
              <label for="nom">Nom de l'√©tiquette :</label>
              <input class="form-control" type="text" placeholder="Nom √©tiquette" id="nom" name="nom"
                [(ngModel)]="etiquette.nom_etiquette">
            </div>

            <button class="btn btnAction me-2" (click)="modifierEtiquette()">
              Modifier
            </button>
            <button class="btn btn-secondary" (click)="annulerModification()">Annuler</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>