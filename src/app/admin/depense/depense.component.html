<app-navbar></app-navbar>
<app-sidebar></app-sidebar>
<div class="zoneSearch container mb-4 mt-4">
  <div class="input-group">
      <input type="search" class="form-control" aria-label="Recipient's username" placeholder="type, numéro,nom,prenom">
      <button class="btn btnSearch" type="button" id="button-addon2"><i class="bi bi-search"></i></button>
    </div>          
</div>

 <!-- Contenu dashbord  -->
 <div class="container mb-5">
  <div class="header mb-4 d-grid gap-2 d-md-flex justify-content-md-end">
    <ul class="nav">
        <li><a [ngClass]="{'currentItemNav': boutonActif === 1}" (click)="showTypeDocument('fournisseur')" (click)="boutonActif = 1" >Fournisseurs</a></li>
        <li><a [ngClass]="{'currentItemNav': boutonActif === 2}" (click)="showTypeDocument('depense')" (click)="boutonActif = 2" >Dépenses</a></li>
    </ul>
  </div>

<div class="contenu">
  <div class="col-md-12 px-4" id="fournisseur" *ngIf="currentDoc==='fournisseur'">
    <div class="card mb-4 px-4 py-2 pt-4 rounded-4">
      <button type="button" class="btn ajouter  col-md-2 mb-3 mt-4" data-bs-toggle="modal" data-bs-target="#addfournisseur">
        Ajouter Fournisseur
     </button>
        <div class="row sectionEspace ligneReseauSearch mb-3">
            <div class="col-md-5">
                <h3 class="fw-bold">Listes Fournisseurs</h3>
            </div>
              <div class="col-md-7">
              </div>
        </div>

        <!-- Le tableau des fournisseurs -->
        <div class="table-responsive">
            <table class="table table-hover mb-4">
                <thead class="mb-2">
                    <tr>
                        <th scope="col">Numéro </th>
                        <th scope="col">Type Fournisseur>
                        <th scope="col">Nom Complet</th>
                        <th scope="col">Adresse </th>
                        <th scope="col">Email </th>
                        <th scope="col">Téléphone </th>
                        <th scope="col">Action </th>
                    </tr>
                </thead>
                <tbody *ngFor="let fournisseur of getItemsPage()" >
                <tr>
                   <td>{{fournisseur.num_fournisseur}}</td>
                   <td>{{fournisseur.type_fournisseur}}</td>
                   <td>{{fournisseur.prenom_fournisseur}} {{fournisseur.nom_fournisseur}}</td>
                   <td>{{fournisseur.adress_fournisseur}}</td>
                   <td>{{fournisseur.email_fournisseur}}</td>
                   <td>{{fournisseur.tel_fournisseur}}</td>
                   <td>
                    <i class="bi bi-pencil-square me-2" title="modifier" (click)="chargerInfoFournisseur(fournisseur)" data-bs-toggle="modal" data-bs-target="#updateFournisseur"></i>
                    <i class="bi bi-trash3" title="Supprimer" (click)="supprimerFournisseur(fournisseur.id)"></i>
                   </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div *ngIf="getItemsPage().length">
          <div class="d-flex justify-content-end mb-2">
              <button class="border border-0 btnColor  mx-2" [disabled]="pageActuelle === 1"
                  (click)="pageActuelle = pageActuelle - 1">
                  <i class="bi bi-arrow-left-circle fs-4"></i>
              </button>
              <button class=" rounded-circle mx-2 page" *ngFor="let page of pages" (click)="pageActuelle = page">
                  <span class="pageActuelle fs-5" *ngIf="page===pageActuelle">{{page}}</span>
                  <span *ngIf="page != pageActuelle">{{page}}</span>
              </button>
              <button class="border border-0 btnColor mx-2" [disabled]="pageActuelle === totalPages"
                  (click)="pageActuelle = pageActuelle + 1">
                  <i class="bi bi-arrow-right-circle fs-4"></i>
              </button>
          </div> 
      </div>
    </div>
  </div>
  <div class="col-md-12 px-4" id="depense" *ngIf="currentDoc==='depense'">
    <div class="card mb-4 px-4 py-2 pt-4 rounded-4">
      <button type="button" class="btn ajouter  col-md-2 mb-3 mt-4" data-bs-toggle="modal" data-bs-target="#adddepence">
        Ajouter Dépense
     </button>
        <div class="row sectionEspace ligneReseauSearch mb-3">
            <div class="col-md-5">
                <h3 class="fw-bold">Listes Dépenses</h3>
            </div>
              <div class="col-md-7">
              </div>
        </div>

        <!-- Le tableau des depenses -->
        <div class="table-responsive">
            <table class="table table-hover mb-4">
                <thead class="mb-2">
                    <tr>
                        <th scope="col">Numéro </th>
                        <th scope="col">Type Fournisseur>
                        <th scope="col">Nom Complet</th>
                        <th scope="col">Adresse </th>
                        <th scope="col">Email </th>
                        <th scope="col">Téléphone </th>
                        <th scope="col">Action </th>
                    </tr>
                </thead>
                <tbody *ngFor="let fournisseur of getItemsPage()" >
                <tr>
                   <td>{{fournisseur.num_fournisseur}}</td>
                   <td>{{fournisseur.type_fournisseur}}</td>
                   <td>{{fournisseur.prenom_fournisseur}} {{fournisseur.nom_fournisseur}}</td>
                   <td>{{fournisseur.adress_fournisseur}}</td>
                   <td>{{fournisseur.email_fournisseur}}</td>
                   <td>{{fournisseur.tel_fournisseur}}</td>
                   <td>
                    <i class="bi bi-pencil-square me-2" title="modifier" (click)="chargerInfoFournisseur(fournisseur)" data-bs-toggle="modal" data-bs-target="#updateFournisseur"></i>
                    <i class="bi bi-trash3" title="Supprimer" (click)="supprimerFournisseur(fournisseur.id)"></i>
                   </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div *ngIf="getItemsPage().length">
          <div class="d-flex justify-content-end mb-2">
              <button class="border border-0 btnColor  mx-2" [disabled]="pageActuelle === 1"
                  (click)="pageActuelle = pageActuelle - 1">
                  <i class="bi bi-arrow-left-circle fs-4"></i>
              </button>
              <button class=" rounded-circle mx-2 page" *ngFor="let page of pages" (click)="pageActuelle = page">
                  <span class="pageActuelle fs-5" *ngIf="page===pageActuelle">{{page}}</span>
                  <span *ngIf="page != pageActuelle">{{page}}</span>
              </button>
              <button class="border border-0 btnColor mx-2" [disabled]="pageActuelle === totalPages"
                  (click)="pageActuelle = pageActuelle + 1">
                  <i class="bi bi-arrow-right-circle fs-4"></i>
              </button>
          </div> 
      </div>
    </div>
  </div>
</div>

<!-- Modal configuration numéro -->
<div class="modal fade mt-5" id="setting" tabindex="-1" aria-labelledby="settingLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="d-grid gap-2 p-2 d-md-flex justify-content-md-end">
        <button type="button" class="btn-close" data-bs-dismiss="modal"  aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="config">
          <h1>Configurer numérotation automatique de ventes</h1>
          
          <div class="option">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="" id="flexCheckIndeterminate" checked>
              <label class="form-check-label" for="flexCheckIndeterminate">
                Champ numéro modifiable
              </label>
            </div>
          </div>
          

          <div class="form-check ">
            <input class="form-check-input" type="radio" name="flexRadioDefault" value="par_defaut" [(ngModel)]="numerotation"  id="flexRadioDefault1" (click)="showNumConfig('sansPrefixes')" checked>
            <label class="form-check-label" for="flexRadioDefault1">
              Numérotation par défaut (incrémentée de façon alphanumérique)
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="flexRadioDefault" value="avec_prefixe" [(ngModel)]="numerotation" id="flexRadioDefault2" (click)="showNumConfig('avecPrefixes')" >
            <label class="form-check-label" for="flexRadioDefault2">
              Numérotation avec préfixe
            </label>
          </div>
          
          <div class="option"  id="avecPrefixes" *ngIf="currentNumConfig==='avecPrefixes'">
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="custom" (change)="updatePrefix()">
                Préfixe personnalisé : 
                <input type="text" [disabled]="selectedPrefix !== 'custom'" [(ngModel)]="customPrefix" (ngModelChange)="updatePrefix()">
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee" (change)="updatePrefix()">
                Préfixe avec l'année en cours
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee_mois" (change)="updatePrefix()">
                Préfixe avec l'année et le mois en cours
              </label>
              <label class="radio-label">
                <input type="radio" name="prefix" [(ngModel)]="selectedPrefix" value="annee_mois_jour" (change)="updatePrefix()">
                Préfixe avec l'année, le mois et le jour en cours
              </label>
            </div>
            <div class="next-number">
              <label>Prochain numéro :</label>
              <input type="text" name="nextNumber" [(ngModel)]="nextNumber" readonly>
            </div>
          </div>

          <div  id="sansPrefixes" *ngIf="currentNumConfig==='sansPrefixes'">
            <div class="next-number">
              <label>Prochain numéro :</label>
              <input type="text"  [(ngModel)]="nextNumber" readonly>
            </div>
          </div>
          
          
          <button class="save-btn" data-bs-toggle="modal" data-bs-target="#fournisseur" (click)="configurationNumero()">Sauvegarder</button>
      </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal ajouter fournisseur -->
<div class="modal fade mt-5" id="addfournisseur" tabindex="-1" aria-labelledby="addfournisseurLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered ">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="addfournisseurLabel">Ajouter Fournisseur</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="containerFournisseur">
          <div class="header">
            <label for="numero">Numéro :&nbsp;</label>
            <input class="w-50" type="text" id="numero" name="nextNumber"[(ngModel)]="nextNumber" readonly>&nbsp;
            <i class="bi bi-gear" data-bs-toggle="modal" data-bs-target="#setting"></i>
          </div> <br><br>
          <div class="tabs">
            <div class="tab" 
            [ngClass]="{'active': zoneActif === 1}" 
            (click)="showComponant('particulier'); setTypeFournisseur('particulier'); zoneActif = 1">
         👤
       </div>
       <div class="tab" 
            [ngClass]="{'active': zoneActif === 2}" 
            (click)="showComponant('entreprise'); setTypeFournisseur('entreprise'); zoneActif = 2">
         🏢
       </div>
          </div>
          <form id="particulier" *ngIf="currentContent==='particulier'">
            <input type="text" placeholder="Prénom" name="prenom" [(ngModel)]="prenom">
            <input type="text" placeholder="Nom" name="nom" [(ngModel)]="nom">
            <input type="text" placeholder="Adresse électronique" name="email" [(ngModel)]="email"><br><br>
            <input type="text" placeholder="Adresse" name="adresse" [(ngModel)]="adresse">
            <div class="row p-2">
                <input type="text" placeholder="Code Postal" name="codepostal" [(ngModel)]="codepostal">
                <input type="text" placeholder="Ville" name="ville" [(ngModel)]="ville">
            </div>
            <input type="text" placeholder="Pays" name="pays" [(ngModel)]="pays">
            <input type="text" placeholder="Téléphone 1" name="tel" [(ngModel)]="tel">
            <textarea placeholder="Commentaire :" name="note" [(ngModel)]="note"></textarea>
        </form>
          <form id="entreprise" *ngIf="currentContent==='entreprise'">
              <input type="text" placeholder="Nom de l'entreprise" name="nomEntreprise" [(ngModel)]="nomEntreprise">
              <input type="text" placeholder="N° Identification fiscale" name="codeFiscal" [(ngModel)]="codeFiscal">
              <input type="text" placeholder="Adresse électronique" name="email" [(ngModel)]="email"><br><br>
              <input type="text" placeholder="Adresse" name="adresse" [(ngModel)]="adresse">
              <div class="row p-2">
                  <input type="text" placeholder="Code Postal" name="codepostal" [(ngModel)]="codepostal">
                  <input type="text" placeholder="Ville" name="ville" [(ngModel)]="ville">
              </div>
              <input type="text" placeholder="Pays" name="pays" [(ngModel)]="pays">
              <input type="text" placeholder="Téléphone 1" name="tel" [(ngModel)]="tel">
              <textarea placeholder="Commentaire :" name="note" [(ngModel)]="note"></textarea>
           
          </form>
      </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btnAction" (click)="addFournisseur()">Ajouter</button>
      <button type="button" class="btn btnClose" data-bs-dismiss="modal">Annuler</button>
    </div>
    </div>
  </div>
</div>

<!-- Modal modifier fournisseur -->
<div class="modal fade mt-5" id="updateFournisseur" tabindex="-1" aria-labelledby="updateFournisseurLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered ">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="updateFournisseurLabel">Modifier Fournisseur</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="containerFournisseur">
          <div class="header">
            <span>{{numFournisseur}}</span>
          </div> <br><br>
          <div class="tabs">
            <div class="tab" 
            [ngClass]="{'active': zoneActif === 1}" 
            (click)="showComponant('particulier'); setTypeFournisseur('particulier'); zoneActif = 1">
         👤
       </div>
       <div class="tab" 
            [ngClass]="{'active': zoneActif === 2}" 
            (click)="showComponant('entreprise'); setTypeFournisseur('entreprise'); zoneActif = 2">
         🏢
       </div>
          </div>
          <form id="particulier" *ngIf="currentContent==='particulier'">
            <input type="text" placeholder="Prénom" name="prenom" [(ngModel)]="prenom">
            <input type="text" placeholder="Nom" name="nom" [(ngModel)]="nom">
            <input type="text" placeholder="Adresse électronique" name="email" [(ngModel)]="email"><br><br>
            <input type="text" placeholder="Adresse" name="adresse" [(ngModel)]="adresse">
            <div class="row p-2">
                <input type="text" placeholder="Code Postal" name="codepostal" [(ngModel)]="codepostal">
                <input type="text" placeholder="Ville" name="ville" [(ngModel)]="ville">
            </div>
            <input type="text" placeholder="Pays" name="pays" [(ngModel)]="pays">
            <input type="text" placeholder="Téléphone 1" name="tel" [(ngModel)]="tel">
            <textarea placeholder="Commentaire :" name="note" [(ngModel)]="note"></textarea>
        </form>
          <form id="entreprise" *ngIf="currentContent==='entreprise'">
              <input type="text" placeholder="Nom de l'entreprise" name="nomEntreprise" [(ngModel)]="nomEntreprise">
              <input type="text" placeholder="N° Identification fiscale" name="codeFiscal" [(ngModel)]="codeFiscal">
              <input type="text" placeholder="Adresse électronique" name="email" [(ngModel)]="email"><br><br>
              <input type="text" placeholder="Adresse" name="adresse" [(ngModel)]="adresse">
              <div class="row p-2">
                  <input type="text" placeholder="Code Postal" name="codepostal" [(ngModel)]="codepostal">
                  <input type="text" placeholder="Ville" name="ville" [(ngModel)]="ville">
              </div>
              <input type="text" placeholder="Pays" name="pays" [(ngModel)]="pays">
              <input type="text" placeholder="Téléphone 1" name="tel" [(ngModel)]="tel">
              <textarea placeholder="Commentaire :" name="note" [(ngModel)]="note"></textarea>
           
          </form>
      </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btnAction" (click)="updateFournisseur()">Modifier</button>
      <button type="button" class="btn btnClose" data-bs-dismiss="modal">Annuler</button>
    </div>
    </div>
  </div>
</div>

<!-- Modal ajout catégorie -->
<div class="modal fade mt-5" id="categorie" tabindex="-1" aria-labelledby="categorieLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="d-grid gap-2 p-2 d-md-flex justify-content-md-end">
        <button type="button" class="btn-close" data-bs-dismiss="modal"  aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h3>+ Ajouter catégorie dépense</h3>
        <div class="form-floating mb-3">
          <input type="text" class="form-control" id="text" name="categorie">
          <label for="text">Nom Catégorie</label>
      </div>
        <button class="btnAction mx-auto btn mt-3" data-bs-toggle="modal" data-bs-target="#adddepence">Sauvegarder</button>
      </div>
    </div>
  </div>
</div>


<!-- Modal ajouter depense -->
<div class="modal fade mt-5" id="adddepence" tabindex="-1" aria-labelledby="adddepenceLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered ">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="adddepenceLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="form-container">
          <div class="row">
            <div class="status-bar col-4">
              <div class="toggle">
                <div class="toggle-slider"></div>
              </div>
              <span class="status-text">Active</span>
            </div>
  
            <div class="header col-8">
              <label for="numero">Numéro :&nbsp;</label>
              <input class="w-50" type="text" id="numero" name="nextNumber"[(ngModel)]="nextNumber" readonly>&nbsp;
              <i class="bi bi-gear" data-bs-toggle="modal" data-bs-target="#setting"></i>
            </div>
          </div>
          

          <div class="form-group">
            <label for="category">Catégorie :</label>
            <select id="category">
              <option  data-bs-toggle="modal" data-bs-target="#categorie">+ Ajouter une catégorie...</option>
              <option value="" disabled selected>Sélectionnez une catégorie...</option>
            </select>
          </div>

          <div class="form-group">
            <label for="comment">Commentaire (facultatif) :</label>
            <textarea id="comment"></textarea>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="defaultCheck1">
            <label class="form-check-label" for="defaultCheck1">
              Dépense avec plusieurs paiements
            </label>
          </div>

          <div class="section Échéance text-center mx-auto p-2">
            <div class="row">
              <ng-container class="mb-2" *ngFor="let item of input; let i = index">
                <div class="col-2"><label for="echeance1" class="me-1">Échéance {{i+1}}: </label></div>
                <div class="col-4"><input type="date"  id="echeance1" class="me-2" value="" [(ngModel)]="item.date" ></div>
                <div class="col-4"><input type="number" id="montant1"  class="me-2" value="" [(ngModel)]="item.prix"> </div>
                <div class="col-2"><i class="bi bi-x-lg" style="color: red; cursor: pointer;" (click)="deleteInput(i)"></i></div>
              </ng-container >
              <span (click)="addInput()" style="cursor: pointer;"><i class="bi bi-plus-circle me-2"></i>ajouter</span>
            </div>
          </div>
        

          <div class="payment-options">
            <div class="checkbox-group">
              <input type="checkbox" id="indeterminateDuration">
              <label for="indeterminateDuration">Durée indéterminée (nombre de paiements inconnu)</label>
              <span class="info-icon">ℹ️</span>
            </div>

            <div class="schedule-options">
              <p>Ces échéances doivent être programmées :</p>
              <div class="checkbox-group">
                <input type="checkbox" id="recurringPayment">
                <label for="recurringPayment">Une échéance tous les :</label>
                <input type="number" class="small-input">
                <select>
                  <option>Mois</option>
                </select>
              </div>

              <div class="form-group">
                <label>À partir du :</label>
                <div class="date-input">
                  <span class="calendar-icon">📅</span>
                  <input type="text" placeholder="Date">
                </div>
              </div>

              <div class="form-group">
                <label>Montant :</label>
                <div class="amount-input">
                  <span class="currency-symbol">$</span>
                  <input type="text" placeholder="Montant">
                </div>
              </div>
            </div>

            <div class="payment-count">
              <label>Combien d'échéances ?</label>
              <input type="number" value="1" class="small-input">
            </div>

            <div class="payment-info">
              <h3>Information du paiement</h3>
              <div class="form-group">
                <label>Date :</label>
                <div class="date-input">
                  <span class="calendar-icon">📅</span>
                  <input type="text" value="29/07/2024">
                </div>
              </div>
              <div class="form-group">
                <label>TVA :</label>
                <select>
                  <option>Sans TVA</option>
                </select>
              </div>
              <div class="form-group">
                <label>Montant :</label>
                <div class="amount-input">
                  <span class="currency-symbol">$</span>
                  <input type="text" placeholder="Montant">
                </div>
              </div>
              <div class="checkbox-group">
                <input type="checkbox" id="unpaid">
                <label for="unpaid">Impayé</label>
              </div>
            </div>

            <div class="billing-info">
              <h3>Information de facturation</h3>
              <div class="form-group">
                <label>Numéro :</label>
                <input type="text">
              </div>
              <div class="form-group">
                <label>Date :</label>
                <div class="date-input">
                  <span class="calendar-icon">📅</span>
                  <input type="text">
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btnAction">Ajouter</button>
      <button type="button" class="btn btnClose" data-bs-dismiss="modal">Annuler</button>
      </div>
    </div>
  </div>
</div>
